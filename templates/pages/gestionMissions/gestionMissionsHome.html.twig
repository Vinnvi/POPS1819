{% extends 'topBar.html.twig' %}
{% block title %} Gestion des missions {% endblock %}
{% block body %}
    <div class="container">
        <div class="row">
            <div class="col s12 m4 l4 push-l4 push-m4">
                <a class="waves-effect waves-light btn modal-trigger" href="#modalAjout">Ajouter une mission</a>
            </div>
        </div>
        <div class="row">
            {% for mission in missions %}
                <div class="col s12 m4 l4">
                    <div class="card blue-grey darken-1">
                        <div class="card-content white-text">
                            <span class="card-title">{{ mission.nom }}</span>
                            <p>{{ mission.description }}</p>
                        </div>
                        <div class="card-action">
                            <a class="modalAjout modal-trigger" data-id="{{ mission.id }}/{{ mission.nom }}/{{ mission.description }}/{{ mission.dateDebut|date("Y-m-d") }}/{{ mission.dateFin|date("Y-m-d") }}" href="#modalAjout"><i class="material-icons">edit</i></a>
                            <a href="{{ path('gestion.mission.collabos',{id: mission.id}) }}"><i class="material-icons">person_add</i></a>
                            <a href="{{ path('gestion.mission.lignes',{id: mission.id}) }}" ><i class="material-icons">euro_symbol</i></a>
                            <a href="#" ><i class="material-icons">timer</i></a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <div id="modalAjout" name="modalAjout" class="modal">
        <div class="row">
            <form method="post" action="{{ path('ajout.Mission') }}" class="col s12">
                <div class="modal-content">
                    <div class="row">
                        <div class="input-field col s6">
                            <input placeholder="Nom du projet" id="nom" name="nom" type="text" class="validate" required>
                            <label for="nom">Nom</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s12">
                            <textarea placeholder="description du projet" id="description" name="description" class="materialize-textarea"></textarea>

                        </div>
                    </div>
                    <div class="row">
                        <input id="dateDebut" name="dateDebut" type="text" class="col s12 datepicker" required>
                        <label for="dateDebut">Date de d√©but</label>
                    </div>
                    <div class="row">
                        <input id="dateFin" name="dateFin" type="text" class="col s12 datepicker" required>
                        <label for="dateFin">Date de fin</label>
                    </div>
                    <input type="hidden" id="id" name="id"/>
                </div>
                <div class="modal-footer">
                    <div class="col s6 center-align">
                        <a href="#!" class="modal-close waves-effect waves-light btn red" onclick="remove()" style="margin:auto;">Annuler</a>
                    </div>
                    <div class="col s6 center-align">
                        <button type="submit" class="waves-effect waves-light btn green" style="margin:auto;">Valider</button>
                    </div>
                </div>
            </form>
        </div>
    </div>


    <div class="js-user-rating" data-time="{{ dateActuelle|date("Y-m-d")}}">
        <!-- ... -->
    </div>
{% endblock %}

{% block javascripts %}
    <script>
        var time = $('.js-user-rating').data('time');

        function remove() {
            $(".modal-content #id").val( null );
            $(".modal-content #nom").val( null );
            $(".modal-content #description").val( null );
            $(".modal-content #dateDebut").val( null );
            $(".modal-content #dateFin").val( null );
        }

        $(document).ready(function(){
            $('.modal').modal({
                onCloseEnd: remove(),
                onCloseStart: remove(),
            });
            $('.datepicker').datepicker({
                format: 'yyyy-mm-dd',
                container: document.getElementById("modalAjout"),
                autoClose: true,
                //minDate: new Date(2019, 10 - 1, 25),
            });
        });
    </script>

    <script>
        $(document).on("click", ".modalAjout", function () {
            var data = $(this).data('id').split('/');
            $(".modal-content #id").val( data[0] );
            $(".modal-content #nom").val( data[1] );
            $(".modal-content #description").val( data[2] );
            $(".modal-content #dateDebut").val( data[3] );
            $(".modal-content #dateFin").val( data[4] );

        });

    </script>

{% endblock %}